<div class="bg-white">
    <div class="mx-auto max-w-2xl px-4 sm:px-6 lg:max-w-7xl lg:px-8">
        <div class="mt-20 grid grid-cols-1 gap-x-6 gap-y-10 sm:grid-cols-2 lg:grid-cols-4 xl:gap-x-8">
            <% @products.each do |product| %>
            <div class="group relative">
                <div class="relative overflow-hidden rounded-md bg-gray-200">
                    <!-- Swiper container for product images -->
                    <div class=" swiper swiper-<%= product.id %> aspect-h-1 aspect-w-1 w-full overflow-hidden rounded-md bg-gray-200">
                        <div class="swiper-wrapper">
                            <% product.images.each do |image| %>
                            <div class="swiper-slide flex items-center justify-center">
                                <%= image_tag image, alt: "product images", class: "h-full w-full object-cover object-center" %>
                            </div>
                            <% end %>
                        </div>
                        <!-- Navigation arrows (no pagination) -->
                        <div class="swiper-button-prev swiper-button-prev-<%= product.id %>"></div>
                        <div class="swiper-button-next swiper-button-next-<%= product.id %>"></div>
                    </div>

                    <div class="absolute z-10 right-0 top-0 m-4 ">
                        <!-- ...heart svg... -->
                        <!-- I added a heart icon to change red on hover for favorites with class="size-6 hover:fill-red-600 transition-colors duration-300 ease-in-out  -->
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke="white" class="size-6 hover:fill-red-600 transition-colors duration-300 ease-in-out fill-[rgba(0,0,0,0.5)]" data-status="false" data-controller="wishlist" data-action="click->wishlist#updateWishlistStatus" data-user-logged-in="<%= user_signed_in? %>">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z" />
                        </svg>
                        <%#
                            Here i want to:
                            1. User stimulus contoller for this element svg.
                            2. catch the click event on the svg element and toggle a "filled" class to change its color.
                            3. Send an AJAX request to the server to update the favorite status of the product.
                            4. Update the UI based on the server response (e.g., change the icon color).
                        %>
                    </div>
                    <!-- Product details below slider -->
                </div>

                <div class="mt-2">
                    <div class="flex justify-between">
                        <h3 class="text-base font-medium text-gray-700">
                            <a href="#">
                                <span aria-hidden="true" class="absolute inset-0"></span>
                                <%= product.name %>
                            </a>
                        </h3>
                        <p class="flex items-center text-sm font-light">
                            <!-- ...star svg... -->
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="mr-1 size-4 fill-current">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z" />
                            </svg>
                            <%= (product.average_final_rating).round(2) %>
                        </p>
                    </div>
                    <p class="mt-0.5 text-sm text-gray-500">
                        <%= product.city %>,
                    </p>
                    <p class="mt-0.5 text-sm text-gray-500"><%= product.country %></p>
                    <p class="mt-0.5 text-sm font-light text-black">
                        <span class="font-medium">
                            <%= humanized_money_with_symbol(product.price) %>
                        </span>
                        <!-- ...shipment svg... -->
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="mb-1 inline-block size-4">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                        </svg>
                        Shipment (Duration)
                    </p>
                </div>
            </div>
            <% end %>
        </div>
    </div>
</div>